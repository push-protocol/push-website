"use strict";
(self["webpackChunkpush_website"] = self["webpackChunkpush_website"] || []).push([[5864],{

/***/ 324008:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   assets: () => (/* binding */ assets),
/* harmony export */   contentTitle: () => (/* binding */ contentTitle),
/* harmony export */   "default": () => (/* binding */ MDXContent),
/* harmony export */   frontMatter: () => (/* binding */ frontMatter),
/* harmony export */   metadata: () => (/* binding */ metadata),
/* harmony export */   toc: () => (/* binding */ toc)
/* harmony export */ });
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(474848);
/* harmony import */ var _mdx_js_react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(28453);
/* harmony import */ var _site_src_css_SharedStyling__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(113490);


const frontMatter = {
	slug: 'defi-forensics-harvest-finance',
	title: 'DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance',
	description: 'DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance',
	authors: [
		'push'
	],
	image: './cover-image.webp',
	text: 'Hello and Welcome to DeFi Forensics. DeFi forensics will put the magnifying glass on various DeFi Projects and explore, breakdown, and analyze some of the recent happenings, exploits, and ‚Äútragedies‚Äù that have shaken the DeFi space. We all know that DeFi never sleeps and that something or the other is always happening in this fast-paced space.',
	tags: [
		'Defi',
		'Case Study',
		'Cryptocurrency',
		'Hacking',
		'Blog'
	]
};
const contentTitle = undefined;
const metadata = {
  "permalink": "/push-website/pr-preview/pr-858/blog/defi-forensics-harvest-finance",
  "source": "@site/blog/2020-10-29-defi-forensics-harvest-finance/index.md",
  "title": "DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance",
  "description": "DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance",
  "date": "2020-10-29T00:00:00.000Z",
  "formattedDate": "October 29, 2020",
  "tags": [
    {
      "label": "Defi",
      "permalink": "/push-website/pr-preview/pr-858/blog/tags/defi"
    },
    {
      "label": "Case Study",
      "permalink": "/push-website/pr-preview/pr-858/blog/tags/case-study"
    },
    {
      "label": "Cryptocurrency",
      "permalink": "/push-website/pr-preview/pr-858/blog/tags/cryptocurrency"
    },
    {
      "label": "Hacking",
      "permalink": "/push-website/pr-preview/pr-858/blog/tags/hacking"
    },
    {
      "label": "Blog",
      "permalink": "/push-website/pr-preview/pr-858/blog/tags/blog"
    }
  ],
  "readingTime": 4.003333333333333,
  "hasTruncateMarker": true,
  "authors": [
    {
      "name": "Push Protocol",
      "url": "https://twitter.com/pushprotocol",
      "imageURL": "/assets/blog/authors/authorpush.png",
      "key": "push"
    }
  ],
  "frontMatter": {
    "slug": "defi-forensics-harvest-finance",
    "title": "DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance",
    "description": "DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance",
    "authors": [
      "push"
    ],
    "image": "./cover-image.webp",
    "text": "Hello and Welcome to DeFi Forensics. DeFi forensics will put the magnifying glass on various DeFi Projects and explore, breakdown, and analyze some of the recent happenings, exploits, and ‚Äútragedies‚Äù that have shaken the DeFi space. We all know that DeFi never sleeps and that something or the other is always happening in this fast-paced space.",
    "tags": [
      "Defi",
      "Case Study",
      "Cryptocurrency",
      "Hacking",
      "Blog"
    ]
  },
  "unlisted": false,
  "prevItem": {
    "title": "Ethereum Push Notification Service (EPNS) Litepaper",
    "permalink": "/push-website/pr-preview/pr-858/blog/epns-litepaper"
  },
  "nextItem": {
    "title": "13 DeFi Notifications Ethereum Needs Today",
    "permalink": "/push-website/pr-preview/pr-858/blog/13-defi-notifications-ethereum-needs-today"
  }
};
const assets = {
"image": (__webpack_require__(217626)/* ["default"] */ .A),
"authorsImageUrls": [undefined],
};




const toc = [{
  "value": "<strong>HARVEST FINANCE</strong>",
  "id": "harvest-finance",
  "level": 3
}];
function _createMdxContent(props) {
  const _components = {
    a: "a",
    br: "br",
    em: "em",
    h1: "h1",
    h3: "h3",
    img: "img",
    p: "p",
    strong: "strong",
    ...(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_2__/* .useMDXComponents */ .R)(),
    ...props.components
  };
  return (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
    children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.img, {
        alt: "Cover Image of DeFi ForensicsüïµÔ∏è‚ÄçÔ∏è- HARVEST Finance",
        src: (__webpack_require__(34999)/* ["default"] */ .A) + "",
        width: "1400",
        height: "700"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "Putting the latest DeFi events under the magnifying glass üîç"
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.em, {
          children: "Hello and Welcome to DeFi Forensics. DeFi forensics will put the magnifying glass on various DeFi Projects and explore, breakdown, and analyze some of the recent happenings, exploits, and ‚Äútragedies‚Äù that have shaken the DeFi space. We all know that DeFi never sleeps and that something or the other is always happening in this fast-paced space."
        })
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components.p, {
      children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.em, {
          children: "Previously we had gone over the YAM protocol and its downfall, although not in a DeFi Forensics way, it sure is worth the"
        })
      }), " ", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://medium.com/ethereum-push-notification-service/how-decentralised-notifications-can-revolutionize-on-chain-governance-part-i-ff09e7465279",
        children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
          children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.em, {
            children: "read"
          })
        })
      }), (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.em, {
          children: "."
        })
      })]
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components.p, {
      children: ["In this article, we will be putting our magnifying glass on ", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://harvest.finance",
        children: "Harvest Finance"
      }), " and its recent hack worth about $24 million. So put on your detective hat, channel your inner Sherlock and head on over to 221B Baker Street as we take a deep dive into‚Ä¶", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "HARVEST Finance."
      })]
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h3, {
      id: "harvest-finance",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "HARVEST FINANCE"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components.p, {
      children: ["Harvest Finance, similar to ", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://yearn.finance",
        children: "Yearn Finance"
      }), ", is a DeFi yield aggregator. A yield aggregator is basically a platform that implements investment strategies on different DeFi Projects in order to maximize yields. Dubbed to be Yearn‚Äôs competitor in the field, Harvest, within a fortnight of its launch grew among the ranks in DeFi to gain $1billion in total value locked (TVL). This is despite early warnings in their audit reports as well as concerns of centralization surrounding the project."]
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h1, {
      id: "what-happened",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "What happened?"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "On October 26, 02:53:31 AM +UTC, an anonymous attacker executed the theft of funds from the USDC and USDT vaults of Harvest Finance. The heist resulted in $24 million worth of funds being stolen out of which $2.5 million was sent back, these returned funds will be distributed among those who lost funds in this exploit."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "The Harvest team has been trying to mitigate the effects of this exploit which occurred due to what they call their ‚Äúengineering error‚Äù. As the story unfolds while this article is being written, Harvest is continuously tracking the funds that were stolen and have claimed to have identified the attacker and has been requesting the attacker to return the funds back to its rightful owners and is also offering a bounty of $400k (bounced up from $100k) to anyone who is able to persuade the attacker to return the funds."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "Harvest Finance acted and withdrew all the funds from the shared pools immediately after evaluating the attack and reconstructing its process. This includes DAI, USDC, USDT, TUSD as well as WBTC and renBTC. The funds are currently present in the vaults and cannot suffer from further market manipulation. The attack did not involve DAI, TUSD, WBTC, and renBTC, and the depositors in these vaults were not affected."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "The addresses used for carrying out the heist has been requested to be blacklisted. With the Harvest team not ready to dox the attacker even after their claim that they have identified the attacker and that the attacker is ‚Äúwell known in the crypto community‚Äù, there has been speculation that either the Harvest team has been bluffing all along about the identity of the attacker or they are carrying out an inside job."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h1, {
      id: "how-did-it-happen",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "How did it happen?"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components.p, {
      children: ["With the release of the O", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://medium.com/harvest-finance/harvest-flashloan-economic-attack-post-mortem-3cf900d65217",
        children: "fficial post mortem report"
      }), " of Harvest Finance released by the team itself, we get to see the exact steps in how the attacker managed to pull off such a heist. The entire attack took place with the help of Flash loans and a well-planned arbitrage attack."]
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "The exploits were a series of arbitrage trades between Uniswap, Curve Finance, and Harvest Finance, and the funds were then cashed out via renBTC and Tornado."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("iframe", {
      src: "https://cdn.embedly.com/widgets/media.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A//twitter.com/devops199fan/status/1320579856938119168&image=",
      allowfullscreen: "",
      frameborder: "0",
      height: "795",
      width: "680",
      title: "",
      class: "eo n ff dy bg",
      scrolling: "no"
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "The attacker began taking out flash loans of $50 million worth USDC on Uniswap and used it to swap between the USDC/USDT pool in Harvest to manipulate the market price wildly. The discounted stablecoins were then used to pay back the flash loan, and each successful swap was then converted into ETH and then to renBTC and eventually to BTC."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "There is still a widespread debate on whether or not this attack was ‚Äúillegal‚Äù since the attacker basically just used trade arbitrage ‚Äî a common profit-making technique ‚Äî on a much larger scale with huge amounts of funds which enormously fluctuated the market. One side considers this as the wits of a smart person who used the poor smart contract design to their advantage, whereas the other side of the community vouches that purposely fluctuating a market at such scales to gain massive amounts of profits while leaving the others in the dust is not acceptable and the attacker must be held accountable."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("iframe", {
      src: "https://cdn.embedly.com/widgets/media.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A//twitter.com/bneiluj/status/1320686478486347778&image=",
      allowfullscreen: "",
      frameborder: "0",
      height: "787",
      width: "680",
      title: "",
      class: "eo n ff dy bg",
      scrolling: "no"
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h1, {
      id: "why-did-it-happen",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "Why did it happen"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "One of the major reasons this attack happened was because of a single design flaw in Harvest Finance‚Äôs smart contract design."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "According to @PancakeBunnyFin‚Äôs analysis and also as confirmed by the Harvest Finance team, the loose smart contract design by Harvest is what cost them $24 million. The arbitrary check function in the contract had a tolerance value of 3% which was too much."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "‚ÄúThe price of a share before the attack was 0.980007 USDC, so the attacker decreased the value of the share by approximately 1%. The arbitrage check inside Harvest‚Äôs strategy did not exceed the threshold of 3% and thus did not revert the transaction.‚Äù"
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("iframe", {
      src: "https://cdn.embedly.com/widgets/media.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A//twitter.com/pancakebunnyfin/status/1320615025560547328&image=",
      allowfullscreen: "",
      frameborder: "0",
      height: "950",
      width: "680",
      title: "",
      class: "eo n ff dy bg",
      scrolling: "no"
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h1, {
      id: "this-is-where-epns-can-help",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "This is where EPNS can help"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "Although hacks and exploits will continue to happen, EPNS is building infrastructure to help trigger actions in a more timely, automated, and accurate manner. In other words, EPNS can help mitigate the after-effects much quicker and effectively."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("iframe", {
      src: "https://cdn.embedly.com/widgets/media.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A//twitter.com/harvest_finance/status/1320614699684298754&image=",
      allowfullscreen: "",
      frameborder: "0",
      height: "417",
      width: "680",
      title: "",
      class: "eo n ff dy bg",
      scrolling: "no"
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "Along with the fact that sharing the attacker‚Äôs BTC addresses on Twitter to blacklist them may not seem intuitive, this approach can be quite slow, giving the attacker ample time to move their funds elsewhere, and also doesn‚Äôt ensure that all stakeholders in the project are aware that such an incident took place."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "With the help of EPNS, one can make sure that risk is always mitigated when such exploits happen."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h1, {
      id: "what-next-for-harvest",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "What next for HARVEST?"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "Harvest is still on the chase to recover funds and has resolved to even commend the skills of the attacker and requesting the attacker to return the funds."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "The team is also considering further mitigation strategies to be used to prevent a similar case in the future, such as implementing a commit-and-reveal mechanism for deposits, a stricter configuration of the existing deposit arb checks in the strategies, among other steps."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "One can only wait and see what happens as the situation unravels. DeFi never fails to keep you on the edge of your seat. We wish the Harvest team and community best of luck as they overcome the recent challenges."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "Never a dull day in DeFi."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: "This article will be updated in the coming days."
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.p, {
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "This was‚Ä¶"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.h1, {
      id: "defi-forensics",
      children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.strong, {
        children: "DeFi Forensics‚Ä¶"
      })
    }), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components.p, {
      children: ["Become part of our buzzing community! Join the conversation on one of our channels:", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.br, {}), "\n", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://epns.io/",
        children: "Website"
      }), " | ", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://twitter.com/epnsproject",
        children: "Twitter"
      }), " | ", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://t.me/epnsproject",
        children: "Telegram"
      }), " | ", (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components.a, {
        href: "https://github.com/push-protocol",
        children: "Github"
      })]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = {
    ...(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_2__/* .useMDXComponents */ .R)(),
    ...props.components
  };
  return MDXLayout ? (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(MDXLayout, {
    ...props,
    children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_createMdxContent, {
      ...props
    })
  }) : _createMdxContent(props);
}



/***/ }),

/***/ 217626:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (__webpack_require__.p + "assets/images/cover-image-806c44d800ad4f2ae3bcc8e19df581ca.webp");

/***/ }),

/***/ 34999:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (__webpack_require__.p + "assets/images/cover-image-806c44d800ad4f2ae3bcc8e19df581ca.webp");

/***/ }),

/***/ 28453:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   R: () => (/* binding */ useMDXComponents),
/* harmony export */   x: () => (/* binding */ MDXProvider)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(296540);
/**
 * @typedef {import('mdx/types.js').MDXComponents} MDXComponents
 * @typedef {import('react').Component<{}, {}, unknown>} Component
 * @typedef {import('react').ReactNode} ReactNode
 */

/**
 * @callback MergeComponents
 *   Custom merge function.
 * @param {Readonly<MDXComponents>} currentComponents
 *   Current components from the context.
 * @returns {MDXComponents}
 *   Additional components.
 *
 * @typedef Props
 *   Configuration for `MDXProvider`.
 * @property {ReactNode | null | undefined} [children]
 *   Children (optional).
 * @property {Readonly<MDXComponents> | MergeComponents | null | undefined} [components]
 *   Additional components to use or a function that creates them (optional).
 * @property {boolean | null | undefined} [disableParentContext=false]
 *   Turn off outer component context (default: `false`).
 */



/** @type {Readonly<MDXComponents>} */
const emptyComponents = {}

const MDXContext = react__WEBPACK_IMPORTED_MODULE_0__.createContext(emptyComponents)

/**
 * Get current components from the MDX Context.
 *
 * @param {Readonly<MDXComponents> | MergeComponents | null | undefined} [components]
 *   Additional components to use or a function that creates them (optional).
 * @returns {MDXComponents}
 *   Current components.
 */
function useMDXComponents(components) {
  const contextComponents = react__WEBPACK_IMPORTED_MODULE_0__.useContext(MDXContext)

  // Memoize to avoid unnecessary top-level context changes
  return react__WEBPACK_IMPORTED_MODULE_0__.useMemo(
    function () {
      // Custom merge via a function prop
      if (typeof components === 'function') {
        return components(contextComponents)
      }

      return {...contextComponents, ...components}
    },
    [contextComponents, components]
  )
}

/**
 * Provider for MDX context.
 *
 * @param {Readonly<Props>} properties
 *   Properties.
 * @returns {JSX.Element}
 *   Element.
 * @satisfies {Component}
 */
function MDXProvider(properties) {
  /** @type {Readonly<MDXComponents>} */
  let allComponents

  if (properties.disableParentContext) {
    allComponents =
      typeof properties.components === 'function'
        ? properties.components(emptyComponents)
        : properties.components || emptyComponents
  } else {
    allComponents = useMDXComponents(properties.components)
  }

  return react__WEBPACK_IMPORTED_MODULE_0__.createElement(
    MDXContext.Provider,
    {value: allComponents},
    properties.children
  )
}


/***/ })

}]);